DROP TABLE IF EXISTS USERS, ITEMS, BOOKINGS, COMMENTS;

CREATE TABLE IF NOT EXISTS USERS (
  USER_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
  NAME VARCHAR (55),
  EMAIL VARCHAR (55) UNIQUE
);

--CREATE TABLE IF NOT EXISTS ITEM_REQUESTS (
--  ITEM_REQUEST_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
--  DESCRIPTION VARCHAR (255),
--  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
--  CREATED_TIME DATE NOT NULL
--);

CREATE TABLE IF NOT EXISTS ITEMS (
  ITEM_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
  NAME VARCHAR (55) NOT NULL,
  DESCRIPTION VARCHAR (255),
  AVAILABLE BOOLEAN,
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE
--  ITEM_REQUEST_ID INT REFERENCES ITEM_REQUESTS (ITEM_REQUEST_ID) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS BOOKINGS (
  BOOKING_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
  BOOKING_START TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  BOOKING_END TIMESTAMP WITHOUT TIME ZONE NOT NULL,
  ITEM_ID INT NOT NULL REFERENCES ITEMS (ITEM_ID) ON DELETE CASCADE,
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  STATUS INT
);

CREATE TABLE IF NOT EXISTS COMMENTS (
  COMMENT_ID INT GENERATED BY DEFAULT AS IDENTITY NOT NULL PRIMARY KEY,
  TEXT VARCHAR (255) NOT NULL,
  ITEM_ID INT NOT NULL REFERENCES ITEMS (ITEM_ID) ON DELETE CASCADE,
  USER_ID INT NOT NULL REFERENCES USERS (USER_ID) ON DELETE CASCADE,
  CREATED TIMESTAMP WITHOUT TIME ZONE NOT NULL
  );